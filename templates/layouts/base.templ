package layouts

import (
	"app/config"
	"app/templates/components/button"
	"app/templates/components/collapsible"
	"app/templates/components/dialog"
	"app/templates/components/dropdown"
	"app/templates/components/input"
	"app/templates/components/label"
	"app/templates/components/popover"
	"app/templates/components/sidebar"
	"app/templates/components/textarea"
	"app/templates/utils"
)

type BaseProps struct {
	Title string
}

templ Base(props BaseProps) {
	<!DOCTYPE html>
	<html lang="en">
		<head>
			<meta charset="UTF-8"/>
			<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
			<title>{ props.Title } - { config.Config.AppName }</title>
			<link rel="stylesheet" href="/static/css/out.css"/>
			<script defer src="/static/js/htmx.min.js"></script>
			// <script defer src="/static/js/alpine.min.js"></script>
			<script defer src="/static/js/app.js"></script>
			@input.Script()
			@label.Script()
			@sidebar.Script()
			@dialog.Script()
			@popover.Script()
			@collapsible.Script()
			@dropdown.Script()
			@textarea.Script()
		</head>
		<body class="dark" hx-boost="true">
			<header class="border-b">
				<nav class="max-w-lg w-full mx-auto justify-center items-center py-2 px-4 flex flex-wrap sm:flex-nowrap gap-2">
					@button.Button(button.Props{
						Variant: button.VariantGhost,
						Href:    "/",
					}) {
						Home
					}
					@button.Button(button.Props{
						Variant: button.VariantGhost,
						Href:    "/contact",
					}) {
						Contact
					}
					if utils.GetUserData(ctx) == nil {
						@button.Button(button.Props{
							Variant: button.VariantGhost,
							Href:    "/log-in",
						}) {
							Log In
						}
						@button.Button(button.Props{
							Variant: button.VariantGhost,
							Href:    "/sign-up",
						}) {
							Sign Up
						}
					} else {
						@button.Button(button.Props{
							Variant: button.VariantGhost,
							Href:    "/app",
						}) {
							App
						}
						@button.Button(button.Props{
							Variant: button.VariantGhost,
							Attributes: templ.Attributes{
								"hx-post": "/log-out",
								"hx-swap": "none",
							},
						}) {
							Log Out
						}
					}
				</nav>
			</header>
			<main class="max-w-lg w-full grow mx-auto p-4 flex flex-col gap-4">
				{ children... }
			</main>
		</body>
	</html>
}
